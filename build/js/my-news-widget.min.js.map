{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/modules/add-listeners.js","webpack:///./js/modules/init-interaction-observer.js","webpack:///./js/modules/load-data.js","webpack:///./js/my-news-widget.js"],"names":["addListeners","el","toggleBtn","shadowRoot","querySelector","popup","open","classList","add","close","remove","onBtnClick","pressed","getAttribute","setAttribute","addEventListener","evt","preventDefault","newsListChangeObserver","MutationObserver","mutations","forEach","mutation","target","children","length","innerText","interactionObserver","querySelectorAll","observe","childList","initInteractionObserver","arr","STATUS_CHANGE_DELAY","intersectionObserver","IntersectionObserver","entry","onIntersection","rootMargin","threshold","dataset","watched","stopObserving","unobserve","setTimeout","child","loadData","widget","MONTH_NAMES","TMPL","content","data","require","getReadableDate","dateString","date","Date","parse","getDay","getMonth","getFullYear","renderSnippet","snippetElement","cloneNode","title","author","url","isNew","publishedAt","renderSetOfSnippets","fragment","document","createDocumentFragment","element","appendChild","updateNews","NEWS","template","createElement","innerHTML","NewsWidget","shadowDOM","attachShadow","mode","loadNews","bind","HTMLElement","initWidget","widgetEl","customElements","define"],"mappings":"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","file":"my-news-widget.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./js/my-news-widget.js\");\n","const addListeners = (el) => {\n\n  const toggleBtn = el.shadowRoot.querySelector('.js-news-widget-toggle');\n  const popup = el.shadowRoot.querySelector('.news-widget__content');\n\n  const open = () => {\n    popup.classList.add('news-widget__content--active');\n  };\n\n  const close = () => {\n    popup.classList.remove('news-widget__content--active');\n  };\n\n  const onBtnClick = () => {\n    let pressed = (toggleBtn.getAttribute('aria-pressed') === 'true');\n    toggleBtn.setAttribute('aria-pressed', !pressed);\n    if (pressed) {\n      close();\n    } else {\n      open();\n    }\n  };\n\n  toggleBtn.addEventListener('click', (evt) => {\n    evt.preventDefault();\n    onBtnClick();\n  });\n\n  const newsListChangeObserver = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.target.children.length > 0) {\n        toggleBtn.querySelector('span').innerText = mutation.target.children.length;\n        toggleBtn.classList.remove('news-widget__toggle--not-active');\n        el.interactionObserver(mutation.target.querySelectorAll('li'));\n      }\n    });\n  });\n\n  newsListChangeObserver.observe(el.shadowRoot.querySelector('ul'), {childList: true});\n};\n\nexport {addListeners};\n","const initInteractionObserver = (arr) => {\n  const STATUS_CHANGE_DELAY = 1500;\n\n  const intersectionObserver = new IntersectionObserver((entry) => {\n    onIntersection(entry[0].target);\n  }, {\n    rootMargin: '0px',\n    threshold: 1.0,\n  });\n\n  const onIntersection = (el) => {\n    if (!el.dataset.watched) {\n      stopObserving(el);\n    }\n  };\n\n  const stopObserving = (el) => {\n    el.dataset.watched = 'true';\n    intersectionObserver.unobserve(el);\n    setTimeout(() => {\n      el.querySelector('.news-list__status').setAttribute('aria-hidden', 'true');\n    }, STATUS_CHANGE_DELAY);\n  };\n\n  arr.forEach((child) => {\n    intersectionObserver.observe(child);\n  });\n};\n\nexport {initInteractionObserver};\n","const loadData = (widget) => {\n  const MONTH_NAMES = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня',\n    'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'\n  ];\n\n  const TMPL = widget.shadowRoot.querySelector('#snippet-template').content;\n  let data = require('../data/data.json');\n\n  const getReadableDate = (dateString) => {\n    let date = new Date(Date.parse(dateString));\n    return `${date.getDay()} ${MONTH_NAMES[date.getMonth()]} ${date.getFullYear()}`;\n  };\n\n  const renderSnippet = (el) => {\n    let snippetElement = TMPL.cloneNode(true);\n    snippetElement.querySelector('.news-list__title').innerText = el.title ? el.title : '';\n    snippetElement.querySelector('.news-list__author').innerText = el.author ? el.author : '';\n    if (el.url) {\n      snippetElement.querySelector('.news-list__link').setAttribute('href', el.url);\n    }\n    snippetElement.querySelector('.news-list__status').setAttribute('aria-hidden', !el.isNew);\n    snippetElement.querySelector('.news-list__date').innerText = el.publishedAt ? getReadableDate(el.publishedAt) : '';\n    snippetElement.querySelector('.news-list__date').setAttribute('datetime', el.publishedAt ? el.publishedAt : '');\n    return snippetElement;\n  };\n\n  const renderSetOfSnippets = (arr) => {\n    let fragment = document.createDocumentFragment();\n    arr.forEach((element) => {\n      fragment.appendChild(renderSnippet(element));\n    });\n    return fragment;\n  };\n\n  const updateNews = function (arr) {\n    widget.shadowRoot.querySelector('ul').appendChild(renderSetOfSnippets(arr));\n  };\n\n  updateNews(data.NEWS);\n};\n\nexport {loadData};\n","import {loadData} from './modules/load-data';\nimport {initInteractionObserver} from './modules/init-interaction-observer';\nimport {addListeners} from './modules/add-listeners';\n\nconst template = document.createElement('template');\ntemplate.innerHTML = `\n  <link rel=\"stylesheet\" href=\"css/my-news-widget.min.css\">\n  <section class=\"news-widget\">\n  <div class=\"news-widget__content\">\n    <h2 class=\"news-widget__header\">Свежие новости</h2>\n    <ul class=\"news-list\">\n    </ul>\n  </div>\n  <button type=\"button\" class=\"news-widget__toggle news-widget__toggle--not-active btn btn--rss js-news-widget-toggle\" aria-label=\"Открыть список новостей\" aria-pressed=\"false\">\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 24C0 10.7452 10.7452 0 24 0C37.2548 0 48 10.7452 48 24C48 37.2548 37.2548 48 24 48C10.7452 48 0 37.2548 0 24Z\"/><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M36.8 33.6H32.5336C32.5336 23.6008 24.3993 15.4664 14.4002 15.4664V11.2C26.7513 11.2 36.8 21.2488 36.8 33.6ZM14.4002 30.4C14.4002 28.6328 15.833 27.2 17.6002 27.2C19.3674 27.2 20.8002 28.6328 20.8002 30.4C20.8002 32.1672 19.3674 33.6 17.6002 33.6C15.833 33.6 14.4002 32.1672 14.4002 30.4ZM25.0671 33.6H29.3334C29.3334 25.3656 22.6343 18.6664 14.4 18.6664V22.9336C20.2815 22.9336 25.0671 27.7184 25.0671 33.6Z\" fill=\"#ffffff\"/></svg>\n    <span class=\"news-widget__unread\"></span>\n  </button>\n  </section>\n  <template id='snippet-template'>\n    <li class=\"news-list__item\">\n      <span class=\"news-list__status\" aria-hidden=\"true\">new</span>\n      <h3 class=\"news-list__title\"></h3>\n      <p class=\"news-list__author\"></p>\n      <time datetime=\"2020-10-20 19:00\" class=\"news-list__date\"></time>\n      <a href=\"#\" class=\"news-list__link\">Подробнее</a>\n    </li>\n  </template>\n`;\n\nclass NewsWidget extends HTMLElement {\n  constructor() {\n    super();\n\n    const shadowDOM = this.attachShadow({mode: 'open'});\n\n    shadowDOM.appendChild(template.content.cloneNode(true));\n\n    this.loadNews = this.loadNews.bind(this);\n\n    this.interactionObserver = this.interactionObserver.bind(this);\n  }\n\n  connectedCallback() {\n    addListeners(this);\n\n    this.loadNews();\n  }\n\n  loadNews() {\n    loadData(this);\n  }\n\n  interactionObserver(arr) {\n    initInteractionObserver(arr);\n  }\n}\n\nconst initWidget = () => {\n  const widgetEl = document.createElement('news-widget');\n  document.querySelector('main').appendChild(widgetEl);\n  customElements.define('news-widget', NewsWidget);\n};\n\ninitWidget();\n\n"],"sourceRoot":""}